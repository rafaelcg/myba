üí≥ Stripe initialized
üöÄ MyBA API Server running on port 3001
üí° Health check: http://localhost:3001/api/health
üîó Stripe: ‚úÖ Configured
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:50:50.518Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:50:50.537Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:50:54.436Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:50:54.440Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:50:58.828Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:50:58.830Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.366Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.367Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.386Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.387Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.406Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.407Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.427Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.428Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.447Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.448Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.474Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.477Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.501Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.502Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.520Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.521Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.539Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.539Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.576Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.577Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.598Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.599Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.623Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:04.625Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:09.672Z"}
warn: Validation errors for /api/anonymous-session: {"0":{"location":"body","msg":"Valid fingerprint required","path":"fingerprint","type":"field","value":"x"},"service":"myba-api","timestamp":"2025-08-07T17:51:09.707Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:09.707Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:14.765Z"}
üé≠ New anonymous session created: test_fingerprint_123
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:14.772Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:20.586Z"}
üé≠ Anonymous token consumed: test_fingerprint_123 (2 remaining)
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:20.589Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:20.605Z"}
üé≠ Anonymous token consumed: test_fingerprint_123 (1 remaining)
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:20.608Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:20.623Z"}
üé≠ Anonymous token consumed: test_fingerprint_123 (0 remaining)
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:20.625Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:20.641Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:20.642Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:20.678Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:20.692Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:20.779Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:20.794Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:20.889Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:20.918Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:20.985Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:21.009Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:21.065Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:21.067Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:21.086Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:21.088Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:21.106Z"}
warn: Rate limit exceeded for ::ffff:152.42.141.162 on /api/anonymous-session/consume {"service":"myba-api","timestamp":"2025-08-07T17:51:21.109Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:21.109Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:21.125Z"}
warn: Rate limit exceeded for ::ffff:152.42.141.162 on /api/anonymous-session/consume {"service":"myba-api","timestamp":"2025-08-07T17:51:21.127Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:21.127Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:25.630Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:51:25.633Z"}
warn: CORS blocked origin: https://malicious-site.com {"service":"myba-api","timestamp":"2025-08-07T17:51:30.824Z"}
Error: Not allowed by CORS
    at origin (/var/www/html/myba/server.js:76:16)
    at /var/www/html/myba/node_modules/cors/lib/index.js:219:13
    at optionsCallback (/var/www/html/myba/node_modules/cors/lib/index.js:199:9)
    at corsMiddleware (/var/www/html/myba/node_modules/cors/lib/index.js:204:7)
    at Layer.handle [as handle_request] (/var/www/html/myba/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/var/www/html/myba/node_modules/express/lib/router/index.js:328:13)
    at /var/www/html/myba/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/var/www/html/myba/node_modules/express/lib/router/index.js:346:12)
    at next (/var/www/html/myba/node_modules/express/lib/router/index.js:280:10)
    at internalNext (/var/www/html/myba/node_modules/helmet/index.cjs:531:6)
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:02.568Z"}
üé≠ New anonymous session created: anon_h69g0f
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:02.574Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:02.649Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:02.651Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:03.262Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:03.621Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:03.747Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:03.751Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:03.804Z"}
üîÑ [transfer_1754589303810_eew86zzpk] Anonymous token transfer request received
üîÑ [transfer_1754589303810_eew86zzpk] Transferring 3 anonymous tokens from anon_h69g0f to user user_30xb6M0lO6A5jHznfFbVtutoQ9I
üîÑ [transfer_1754589303810_eew86zzpk] Updating Stripe customer: 29 + 3 = 32 tokens
üóëÔ∏è [transfer_1754589303810_eew86zzpk] Removed anonymous session: anon_h69g0f
‚úÖ [transfer_1754589303810_eew86zzpk] Successfully transferred 3 tokens in 494ms
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:04.304Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:05.534Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:05.536Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:11.485Z"}
üé≠ New anonymous session created: anon_h69g0f
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:11.487Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:11.541Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:11.543Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:11.997Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:11.998Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:12.052Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:12.054Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:12.096Z"}
üîÑ [transfer_1754589312098_cvojaz8mb] Anonymous token transfer request received
üîÑ [transfer_1754589312098_cvojaz8mb] Transferring 3 anonymous tokens from anon_h69g0f to user user_30xb6M0lO6A5jHznfFbVtutoQ9I
üîÑ [transfer_1754589312098_cvojaz8mb] Updating Stripe customer: 32 + 3 = 35 tokens
üóëÔ∏è [transfer_1754589312098_cvojaz8mb] Removed anonymous session: anon_h69g0f
‚úÖ [transfer_1754589312098_cvojaz8mb] Successfully transferred 3 tokens in 515ms
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:12.613Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:13.692Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T17:55:13.692Z"}
info: [object Object] {"service":"myba-api","timestamp":"2025-08-07T18:03:28.876Z"}
